@inherits LayoutComponentBase
@inject SessionAuthService SessionAuth
@inject IJSRuntime JSRuntime
@using System.Security.Claims

<div class="page-layout-horizontal">
    <header class="top-navbar-container">
        <NavMenu />
    </header>

    <AuthorizeView>
        <Authorized>
            <div class="welcome-message bg-light border-bottom py-2">
                <div class="container">
                    <div class="text-center text-success">
                        <i class="bi bi-check-circle-fill me-2"></i>
                        Welcome back, <strong>@context.User.FindFirst(ClaimTypes.GivenName)?.Value</strong>! 
                        <span class="text-muted">You are logged in as @context.User.FindFirst("http://schemas.microsoft.com/ws/2008/06/identity/claims/role")?.Value</span>
                    </div>
                </div>
            </div>
        </Authorized>
    </AuthorizeView>

    <main id="main-content" class="main-content-horizontal" tabindex="-1">
        <article class="content px-4">
            @Body
        </article>
    </main>

    <Footer />
</div>

@code { // This class represents the main layout
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await SessionAuth.InitializeAsync(JSRuntime);
        }
    }
}


<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">🗙</span>
</div>

